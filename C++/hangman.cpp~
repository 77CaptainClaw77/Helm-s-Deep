#include <iostream>
#include <cstdlib>
#include <string>
#include <cstring>
using namespace std;
void draw(int mistake)
{
    cout<<"Number of wrong guesses"<<mistake;
    cout<<"\n\n\n\n";
    if(mistake==0) return;
    cout<<" _ _"<<endl;
    if(mistake==1) return;
    cout<<"| |"<<endl;
    if(mistake==2) return;
    cout<<"|( )"<<endl;
    if(mistake==3) return;
    cout<<"| |"<<endl;
    if(mistake==4) return;
    cout<<"|/|\\"<<endl;
    if(mistake==5) return;
    cout<<"| |"<<endl;
    cout<<"|/ \\"<<endl;
    cout<<"You Died!!";
}
int* shift_generator(char const* pattern)
{
  int i;
  int* shft=(int*)malloc(sizeof(int)*128);
  for(i=0;i<128;i++)
    *(shft+i)=strlen(pattern);
  for(i=0;i<strlen(pattern)-1;i++)
    shft[pattern[i]]=strlen(pattern)-i-1;
   /*for(i=0;i<128;i++)
     {if(shft[i]!=strlen(pattern))
	 printf("%c\t",i);
     }
   printf("\n");
  for(i=0;i<128;i++)
     {if(shft[i]!=strlen(pattern))
	 printf("%d\t",shft[i]);
     }*/
   return shft;
}
int horspool_matching(char const* text,char const* pattern,int* shft)
{
  int i=strlen(pattern)-1,count=0;
  while(i<strlen(text))
    {
      count=0;
      while(count<strlen(pattern) &&  text[i-count]==pattern[strlen(pattern)-1-count])
	count++;
      if(count==strlen(pattern))
	return i-strlen(pattern)+1;
      i=i+shft[text[i]];
    }
  return -1;
}
int main()
{
  int wrong=0;
  string word;
  string guess;
  string match;
  cout<<"Enter the word to be guessed: ";
  cin>>word;
  string word_cpy=word;
  int p_count=0;
  for(int i=0;i<word.length();i++)
    match+="_";
  while(wrong<7)
    {
        draw(wrong);
        cout<<"Current State: "<<match;
        if(match==word_cpy)
         {
         cout<<"\nWell Done!! \n You Have Won\n";
         break;
         }
        cout<<endl<<"Enter your next guess: ";
        cin>>guess;
        int* shft=shift_generator(guess.c_str());
        int found_at=horspool_matching(word.c_str(),guess.c_str(),shft);
        if(found_at==-1)
        {
            wrong++;
        }
        else
        {
        for(int i=0;i<guess.length();i++)
        {
            match[found_at+i]=guess[i];
        }
        }
    }
    cout<<"\nNumber of wrong guesses: "<<wrong;
    cout<<"\nThank you for playing!";
  return 0;
}
